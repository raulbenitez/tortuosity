# We get the coordinates of each node belonging to a branch pixel. In addition, degrees will tell us whether it is an end node (degrees=1)
# node among others (degrees=2) or a junction node (degrees=3)

pixel_graph, coordinates, degrees = skeleton_to_csgraph(skeleton2,spacing=pixspac)
labeled_branch, nbranches = label(i,return_num=True)

# To plot both the endpoints and the junction points

endpoints=degrees==1
junctionpoint=degrees==3
points=endpoints+junctionpoint
fig, ax = plt.subplots(figsize=(10,10))
draw.overlay_skeleton_2d(l[2], points, dilate=4, axes=ax)
plt.show()
plt.title('End points and junction points of the aorta and the iliac arteries', size=15)

# We find the position in the image of the main bifurcation point
position=[]
for i,e in enumerate(junctionpoint):
    for t,r in enumerate(junctionpoint):
        if junctionpoint[i][t]==True:
            position.append([i,t])
if len(position)==3:
    position=position[1]
else:
    position=position[0]

        
