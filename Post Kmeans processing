# We select the cluster corresponding to the aorta 
index=np.argmax(kmeans.cluster_centers_)
aorta=I_kmeans==index

# Morphological operations to separate attached structures
selem = disk(3)
eroded = erosion(aorta, selem)
dilated = dilation(eroded, selem)
plt.figure(figsize=(10,10))
plt.imshow(dilated,cmap='Greys_r')

# Labeling process
label_image, nregions = label(dilated,return_num=True)

# Deleting non-interest regions
props=measure.regionprops(label_image)
va = []
for prop in props:
    va.append(prop.area)
indkeep = np.array(np.argmax(va))
v = np.arange(nregions)
vkill = np.setdiff1d(v,indkeep)+1 
I2 = dilated
for kkill in vkill:
    I2[label_image==kkill]=0
plt.figure(figsize=(10,10))
plt.imshow(I2,cmap='Greys_r')

# Making the contour more regular
selem = disk(1)
dilated = dilation(I2, selem)
plt.figure(figsize=(10,10))
plt.imshow(dilated,cmap='Greys_r')
